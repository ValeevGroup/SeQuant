section test_section:
R1{a1;i1} = 42 * A{a1;i1}
R2{a1,a2;i1,i2} = A{a1;i1} A{a2;i2}

=================================================
Plain Text
=================================================
Declare index i_1
Declare index i_2
Declare index a_1
Declare index a_2

section test_section(tensor A[a_1, i_1], tensor R1[a_1, i_1], tensor R2[a_1, a_2, i_1, i_2])
  Create R1[a_1, i_1] and initialize to zero
  Load A[a_1, i_1]
  Compute R1[a_1, i_1] += 42 A[a_1, i_1]
  Unload A[a_1, i_1]
  Persist R1[a_1, i_1]

  Create R2[a_1, a_2, i_1, i_2] and initialize to zero
  Load A[a_1, i_1]
  Compute R2[a_1, a_2, i_1, i_2] += A[a_1, i_1] A[a_2, i_2]
  Unload A[a_1, i_1]
  Persist R2[a_1, a_2, i_1, i_2]
end section

=================================================
Python (einsum)
=================================================
def test_section():

    R1_vo = np.zeros((nvirt, nocc), order='F')
    A_vo = np.load('A_vo.npy')
    R1_vo += 42 * np.einsum('ai->ai', A_vo, optimize=True)
    del A_vo
    np.save('R1_vo.npy', R1_vo)

    R2_vvoo = np.zeros((nvirt, nvirt, nocc, nocc), order='F')
    A_vo = np.load('A_vo.npy')
    R2_vvoo += np.einsum('ai,bc->abic', A_vo, A_vo, optimize=True)
    del A_vo
    np.save('R2_vvoo.npy', R2_vvoo)


=================================================
