<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html"><link rel="next" title="Installation Guide" href="installing.html"><link rel="prev" title="Register Index Spaces" href="index_spaces.html">
        <link rel="prefetch" href="../../_static/logo.svg" as="image">

    <!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>Operators - SeQuant Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-treeview/bootstrap-treeview.min.css?v=8176a87d" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=821744c5" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --sidebar-item-font-size: 0.95em;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">SeQuant Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Getting started</a><input aria-label="Toggle navigation of Getting started" checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="wick.html">Wick’s Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="index_spaces.html">Register Index Spaces</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Operators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guide/index.html">User Guide</a><input aria-label="Toggle navigation of User Guide" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide/operator.html">Operator Interface for Symbolic Many-Body Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/cc.html">Coupled-Cluster Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/io.html">I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/evaluation.html">Evaluation Trace Analysis Using Nushell</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../developer/index.html">Developer docs</a><input aria-label="Toggle navigation of Developer docs" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../developer/documentation.html">Documentation Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Maintainer</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../maintainer/index.html">Maintainer docs</a><input aria-label="Toggle navigation of Maintainer docs" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../maintainer/release.html">Release Guide</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">See Also</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://valeevgroup.github.io/tiledarray">TiledArray</a></li>
<li class="toctree-l1"><a class="reference external" href="https://valeevgroup.github.io/mpqc">Massively Parallel Quantum Chemistry</a></li>
<li class="toctree-l1"><a class="reference external" href="https://valeevgroup.github.io">Valeev Research Group</a></li>
</ul>

</div></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/user/getting_started/operators.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="operators">
<h1>Operators<a class="headerlink" href="#operators" title="Link to this heading">¶</a></h1>
<p>Development of SeQuant is primarily motivated by the perturbative many-body methods, collectively referred to here as Many-Body Perturbation Theory (MBPT). Examples of such methods include the <a class="reference external" href="https://doi.org/10.1017/CBO9780511596834">coupled-cluster (CC) method</a> and <a class="reference external" href="https://doi.org/10.1103/PhysRev.139.A796">GW</a>. The typical use case is to compute canonical forms of products of operators. For example, consider the coupled-cluster doubles (CCD) method.
<em>Amplitudes</em> <span class="math notranslate nohighlight">\(t^{i_1 i_2}_ {a_1 a_2}\)</span> of the cluster operator,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\hat{t} \equiv \hat{t}_ 2 = \frac{1}{4} t^{i_1 i_2}_ {a_1 a_2} a_ {i_1 i_2}^{a_1 a_2},\]</div>
</div>
<p>are determined by solving the CCD equations:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\forall i_1, i_2, a_1, a_2: \quad 0 = \langle0\vert a^{i_1 i_2}_ {a_1 a_2} \exp(-\hat{t}_ 2) \hat{H} \exp(\hat{t}_ 2) \vert 0 \rangle = \langle0\vert a^{i_1 i_2}_ {a_1 a_2} \bigl( \hat{H} + [\hat{H}, \hat{t}_ 2] + \frac{1}{2} [[\hat{H}, \hat{t}_ 2], \hat{t}_ 2] \bigr) \vert 0 \rangle.\]</div>
</div>
<p>A pedestrian way to compose such expression is to define a cluster operator object using SeQuant tensors and normal-ordered operators:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Constant</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="w"> </span><span class="o">*</span>
<span class="w">          </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Tensor</span><span class="o">&gt;</span><span class="p">(</span><span class="sa">L</span><span class="s">&quot;t&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bra</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;a_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;a_2&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">ket</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;i_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;i_2&quot;</span><span class="p">},</span>
<span class="w">                     </span><span class="n">Symmetry</span><span class="o">::</span><span class="n">Antisymm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">          </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">FNOperator</span><span class="o">&gt;</span><span class="p">(</span><span class="n">cre</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;a_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;a_2&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">ann</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;i_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;i_2&quot;</span><span class="p">});</span>
</pre></div>
</div>
<p>The normal-ordered Hamiltonian is defined similarly as a sum of 1- and 2-body contributions:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Tensor</span><span class="o">&gt;</span><span class="p">(</span><span class="sa">L</span><span class="s">&quot;f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bra</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;p_1&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">ket</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;p_2&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">Symmetry</span><span class="o">::</span><span class="n">Nonsymm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">             </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">FNOperator</span><span class="o">&gt;</span><span class="p">(</span><span class="n">cre</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;p_1&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">ann</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;p_2&quot;</span><span class="p">})</span><span class="w"> </span><span class="o">+</span>
<span class="w">         </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Constant</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="w"> </span><span class="o">*</span>
<span class="w">             </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Tensor</span><span class="o">&gt;</span><span class="p">(</span><span class="sa">L</span><span class="s">&quot;g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bra</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;p_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;p_2&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">ket</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;p_3&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;p_4&quot;</span><span class="p">},</span>
<span class="w">                        </span><span class="n">Symmetry</span><span class="o">::</span><span class="n">Antisymm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">             </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">FNOperator</span><span class="o">&gt;</span><span class="p">(</span><span class="n">cre</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;p_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;p_2&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">ann</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;p_3&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;p_4&quot;</span><span class="p">});</span>
</pre></div>
</div>
<p>Note that the compact definition of the Hamiltonian is due to the use of the union (<span class="math notranslate nohighlight">\(p\)</span>) of base occupied (<span class="math notranslate nohighlight">\(i\)</span>) and unoccupied (<span class="math notranslate nohighlight">\(a\)</span>) spaces. Many other symbolic algebras only support use of nonoverlapping base spaces, in terms of which Hamiltonian and other tensor expressions would have a much more verbose form.
The commutator of the Hamiltonian and cluster operators is trivially composed:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">commutator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[](</span><span class="k">auto</span><span class="w"> </span><span class="n">op1</span><span class="p">,</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">op2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">simplify</span><span class="p">(</span><span class="n">op1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">op2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">op2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">op1</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">auto</span><span class="w"> </span><span class="n">c_ht</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">commutator</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">t2</span><span class="p">);</span>
</pre></div>
</div>
<p>Note the use of <code class="code docutils literal notranslate"><span class="pre">simplify</span></code> to rewrite an expression in a simpler form. Its role will be emphasized later.
Unfortunately, we immediately run into the limitation of the “pedestrian” approach. Namely, the double commutator cannot be correctly obtained as</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">c_htt_v1</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Constant</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">commutator</span><span class="p">(</span><span class="n">commutator</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">t2</span><span class="p">),</span><span class="w"> </span><span class="n">t2</span><span class="p">);</span>
</pre></div>
</div>
<p>due to the explicit use of specific dummy indices in the definition of <code class="code docutils literal notranslate"><span class="pre">t2</span></code>. Using it more than once in a given product will produce an expresson where each dummy index appears more than 2 times, breaking the Einstein summation convention.</p>
<p>The issue is actually not the reuse of the same of operator object, but the reuse of dummy indices. A straightforward, but brittle, solution is to ensure that each dummy index is only used once. E.g.,
to use <span class="math notranslate nohighlight">\(\hat{t}_2\)</span> more than once in an expression we must make several versions of it, each with a separate set of dummy indices:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">t2_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Constant</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="w"> </span><span class="o">*</span>
<span class="w">            </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Tensor</span><span class="o">&gt;</span><span class="p">(</span><span class="sa">L</span><span class="s">&quot;t&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bra</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;a_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;a_2&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">ket</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;i_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;i_2&quot;</span><span class="p">},</span>
<span class="w">                       </span><span class="n">Symmetry</span><span class="o">::</span><span class="n">Antisymm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">            </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">FNOperator</span><span class="o">&gt;</span><span class="p">(</span><span class="n">cre</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;a_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;a_2&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">ann</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;i_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;i_2&quot;</span><span class="p">});</span>

<span class="k">auto</span><span class="w"> </span><span class="n">t2_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Constant</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="w"> </span><span class="o">*</span>
<span class="w">            </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Tensor</span><span class="o">&gt;</span><span class="p">(</span><span class="sa">L</span><span class="s">&quot;t&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bra</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;a_3&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;a_4&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">ket</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;i_3&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;i_4&quot;</span><span class="p">},</span>
<span class="w">                       </span><span class="n">Symmetry</span><span class="o">::</span><span class="n">Antisymm</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">            </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">FNOperator</span><span class="o">&gt;</span><span class="p">(</span><span class="n">cre</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;a_3&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;a_4&quot;</span><span class="p">},</span><span class="w"> </span><span class="n">ann</span><span class="p">{</span><span class="sa">L</span><span class="s">&quot;i_3&quot;</span><span class="p">,</span><span class="w"> </span><span class="sa">L</span><span class="s">&quot;i_4&quot;</span><span class="p">});</span>

<span class="k">auto</span><span class="w"> </span><span class="n">c_htt</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Constant</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">commutator</span><span class="p">(</span><span class="n">commutator</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">t2_0</span><span class="p">),</span><span class="w"> </span><span class="n">t2_1</span><span class="p">);</span>
</pre></div>
</div>
<p>This is too error-prone for making complex expressions. A better way is to represent <span class="math notranslate nohighlight">\(\hat{t}_2\)</span> by an object that generates tensor form with unique dummy indices generated on the fly. in SeQuant such MBPT <em>operators</em> live in <code class="code docutils literal notranslate"><span class="pre">mbpt</span></code> namespace. The entire CCD amplitude equation is evaluated as follows:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;SeQuant/core/context.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;SeQuant/core/expr.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;SeQuant/core/io/shorthands.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;SeQuant/core/op.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;SeQuant/domain/mbpt/context.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;SeQuant/domain/mbpt/convention.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;SeQuant/domain/mbpt/op.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;SeQuant/domain/mbpt/vac_av.hpp&gt;</span>

<span class="kr">inline</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">commutator</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">op1</span><span class="p">,</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">op2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">op1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">op2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">op2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">op1</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">sequant</span><span class="p">;</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">sequant</span><span class="o">::</span><span class="nn">mbpt</span><span class="p">;</span>
<span class="w">  </span><span class="n">set_default_context</span><span class="p">({.</span><span class="n">index_space_registry_shared_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_min_sr_spaces</span><span class="p">(),</span>
<span class="w">                       </span><span class="p">.</span><span class="n">vacuum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vacuum</span><span class="o">::</span><span class="n">SingleProduct</span><span class="p">});</span>
<span class="w">  </span><span class="n">set_default_mbpt_context</span><span class="p">({.</span><span class="n">op_registry_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_legacy_registry</span><span class="p">()});</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">hbar</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">H</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">commutator</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="n">ex</span><span class="o">&lt;</span><span class="n">Constant</span><span class="o">&gt;</span><span class="p">(</span><span class="n">rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">commutator</span><span class="p">(</span><span class="n">commutator</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">ccd_eq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vac_av</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hbar</span><span class="p">);</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">wcout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;&lt;&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">to_latex</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hbar</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;&gt; = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">to_latex</span><span class="p">(</span><span class="n">ccd_eq</span><span class="p">)</span>
<span class="w">             </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The result is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\bigl({{{\frac{1}{4}}}{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{\bar{g}^{{i_1}{i_2}}_ {{a_1}{a_2}}}} - {{{\frac{1}{2}}}{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{f^{{a_3}}_ {{a_1}}}{\bar{t}^{{i_1}{i_2}}_ {{a_2}{a_3}}}} - {{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{\bar{g}^{{i_1}{a_3}}_ {{i_3}{a_1}}}{\bar{t}^{{i_2}{i_3}}_ {{a_2}{a_3}}}} + {{{\frac{1}{8}}}{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{\bar{g}^{{a_3}{a_4}}_ {{a_1}{a_2}}}{\bar{t}^{{i_1}{i_2}}_ {{a_3}{a_4}}}}
+ {{{\frac{1}{8}}}{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{\bar{g}^{{i_1}{i_2}}_ {{i_3}{i_4}}}{\bar{t}^{{i_3}{i_4}}_ {{a_1}{a_2}}}} + {{{\frac{1}{2}}}{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{f^{{i_1}}_ {{i_3}}}{\bar{t}^{{i_2}{i_3}}_ {{a_1}{a_2}}}} + {{{\frac{1}{16}}}{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{\bar{g}^{{a_3}{a_4}}_ {{i_3}{i_4}}}{\bar{t}^{{i_1}{i_2}}_ {{a_3}{a_4}}}{\bar{t}^{{i_3}{i_4}}_ {{a_1}{a_2}}}}
- {{{\frac{1}{4}}}{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{\bar{g}^{{a_3}{a_4}}_ {{i_3}{i_4}}}{\bar{t}^{{i_1}{i_3}}_ {{a_3}{a_4}}}{\bar{t}^{{i_2}{i_4}}_ {{a_1}{a_2}}}} - {{{\frac{1}{4}}}{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{\bar{g}^{{a_3}{a_4}}_ {{i_3}{i_4}}}{\bar{t}^{{i_1}{i_2}}_ {{a_1}{a_3}}}{\bar{t}^{{i_3}{i_4}}_ {{a_2}{a_4}}}}
- {{{\frac{1}{4}}}{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{\bar{g}^{{a_3}{a_4}}_ {{i_3}{i_4}}}{\bar{t}^{{i_1}{i_3}}_ {{a_3}{a_4}}}{\bar{t}^{{i_2}{i_4}}_ {{a_1}{a_2}}}} - {{{\frac{1}{4}}}{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{\bar{g}^{{a_3}{a_4}}_ {{i_3}{i_4}}}{\bar{t}^{{i_1}{i_2}}_ {{a_1}{a_3}}}{\bar{t}^{{i_3}{i_4}}_ {{a_2}{a_4}}}}
+ {{{\frac{1}{2}}}{A^{{a_1}{a_2}}_ {{i_1}{i_2}}}{\bar{g}^{{a_3}{a_4}}_ {{i_3}{i_4}}}{\bar{t}^{{i_1}{i_3}}_ {{a_1}{a_3}}}{\bar{t}^{{i_2}{i_4}}_ {{a_2}{a_4}}}}\bigr)\]</div>
</div>
<p>The use of MBPT operators rather than their tensor-level forms not only solves problems with the reuse of dummy indices, but also allows to implement additional optimizations such as algebraic simplifications of complex operator expressions and avoiding evaluation of operator products whose vacuum expectation values are guaranteed to vanish. This allows very efficient derivation of complex equations, e.g. CC equations through CCSDTQ are derived in a fraction of a second on a laptop:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cmake<span class="w"> </span>--build<span class="w"> </span>build<span class="w"> </span>--target<span class="w"> </span>srcc
$<span class="w"> </span><span class="nb">time</span><span class="w"> </span>build/srcc<span class="w">  </span><span class="nb">time</span><span class="w"> </span>./srcc<span class="w"> </span><span class="m">4</span><span class="w"> </span>t<span class="w"> </span>std<span class="w"> </span>so
CC<span class="w"> </span>equations<span class="w"> </span><span class="o">[</span><span class="nv">type</span><span class="o">=</span>t,rank<span class="o">=</span><span class="m">1</span>,spinfree<span class="o">=</span>false,screen<span class="o">=</span>true,use_topology<span class="o">=</span>true,use_connectivity<span class="o">=</span>true,canonical_only<span class="o">=</span>true<span class="o">]</span><span class="w"> </span>computed<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.0027805<span class="w"> </span>seconds
R1<span class="o">(</span>expS1<span class="o">)</span><span class="w"> </span>has<span class="w"> </span><span class="m">8</span><span class="w"> </span>terms:
CC<span class="w"> </span>equations<span class="w"> </span><span class="o">[</span><span class="nv">type</span><span class="o">=</span>t,rank<span class="o">=</span><span class="m">2</span>,spinfree<span class="o">=</span>false,screen<span class="o">=</span>true,use_topology<span class="o">=</span>true,use_connectivity<span class="o">=</span>true,canonical_only<span class="o">=</span>true<span class="o">]</span><span class="w"> </span>computed<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.012890749999999999<span class="w"> </span>seconds
R1<span class="o">(</span>expS2<span class="o">)</span><span class="w"> </span>has<span class="w"> </span><span class="m">14</span><span class="w"> </span>terms:
R2<span class="o">(</span>expS2<span class="o">)</span><span class="w"> </span>has<span class="w"> </span><span class="m">31</span><span class="w"> </span>terms:
CC<span class="w"> </span>equations<span class="w"> </span><span class="o">[</span><span class="nv">type</span><span class="o">=</span>t,rank<span class="o">=</span><span class="m">3</span>,spinfree<span class="o">=</span>false,screen<span class="o">=</span>true,use_topology<span class="o">=</span>true,use_connectivity<span class="o">=</span>true,canonical_only<span class="o">=</span>true<span class="o">]</span><span class="w"> </span>computed<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.039590500000000001<span class="w"> </span>seconds
R1<span class="o">(</span>expS3<span class="o">)</span><span class="w"> </span>has<span class="w"> </span><span class="m">15</span><span class="w"> </span>terms:
R2<span class="o">(</span>expS3<span class="o">)</span><span class="w"> </span>has<span class="w"> </span><span class="m">37</span><span class="w"> </span>terms:
R3<span class="o">(</span>expS3<span class="o">)</span><span class="w"> </span>has<span class="w"> </span><span class="m">47</span><span class="w"> </span>terms:
CC<span class="w"> </span>equations<span class="w"> </span><span class="o">[</span><span class="nv">type</span><span class="o">=</span>t,rank<span class="o">=</span><span class="m">4</span>,spinfree<span class="o">=</span>false,screen<span class="o">=</span>true,use_topology<span class="o">=</span>true,use_connectivity<span class="o">=</span>true,canonical_only<span class="o">=</span>true<span class="o">]</span><span class="w"> </span>computed<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.107501417<span class="w"> </span>seconds
R1<span class="o">(</span>expS4<span class="o">)</span><span class="w"> </span>has<span class="w"> </span><span class="m">15</span><span class="w"> </span>terms:
R2<span class="o">(</span>expS4<span class="o">)</span><span class="w"> </span>has<span class="w"> </span><span class="m">38</span><span class="w"> </span>terms:
R3<span class="o">(</span>expS4<span class="o">)</span><span class="w"> </span>has<span class="w"> </span><span class="m">53</span><span class="w"> </span>terms:
R4<span class="o">(</span>expS4<span class="o">)</span><span class="w"> </span>has<span class="w"> </span><span class="m">74</span><span class="w"> </span>terms:
./srcc<span class="w"> </span><span class="m">4</span><span class="w"> </span>t<span class="w"> </span>std<span class="w"> </span>so<span class="w">  </span><span class="m">0</span>.27s<span class="w"> </span>user<span class="w"> </span><span class="m">0</span>.41s<span class="w"> </span>system<span class="w"> </span><span class="m">100</span>%<span class="w"> </span>cpu<span class="w"> </span><span class="m">0</span>.674<span class="w"> </span>total
</pre></div>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="installing.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Installation Guide</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index_spaces.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Register Index Spaces</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2026, SeQuant developers
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Feb 27, 2026 8:35:02 PM</div>
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-brands fa-solid fa-github fa-2x" href="https://github.com/ValeevGroup/SeQuant" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../_static/bootstrap-treeview/bootstrap-treeview.min.js?v=6a1e96b4"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4.0.0-beta.3/tex-mml-chtml.js"></script>
    </body>
</html>